<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://Z1Nhouse.github.io/</id>
    <title>Z1N&apos;s house</title>
    <updated>2020-02-22T17:05:10.893Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://Z1Nhouse.github.io/"/>
    <link rel="self" href="https://Z1Nhouse.github.io//atom.xml"/>
    <subtitle>System.out.print(&quot;Welcome to Z1N&apos;s house！&quot;);</subtitle>
    <logo>https://Z1Nhouse.github.io//images/avatar.png</logo>
    <icon>https://Z1Nhouse.github.io//favicon.ico</icon>
    <rights>All rights reserved 2020, Z1N&apos;s house</rights>
    <entry>
        <title type="html"><![CDATA[楓之谷私服 - 點裝領取系統]]></title>
        <id>https://Z1Nhouse.github.io//post/Y6qQpOypx</id>
        <link href="https://Z1Nhouse.github.io//post/Y6qQpOypx">
        </link>
        <updated>2020-02-22T16:59:12.000Z</updated>
        <content type="html"><![CDATA[<p>emmmm... 我是不知道別的服怎麼設計的，我就自己隨意寫的</p>
<p>原理很簡單<br>
首先確認你的端口有沒有以下兩種函數(99.99999%都有)</p>
<ul>
<li>sendGetNumber</li>
<li>isCash</li>
</ul>
<p>兩個都有就99.99999%能寫出來</p>
<ol>
<li>先寫選單，看你要怎麼分類</li>
<li>再來每個選單都sendGetNumber並規範一個範圍</li>
<li>新增變數id = 玩家輸入的代碼</li>
<li>得到id 物品</li>
</ol>
<p>這樣就能寫出來了，其他想新增什麼判斷再修一修就行。</p>
<p><img src="https://Z1Nhouse.github.io//post-images/1582390992222.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582390994724.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582390996883.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582391000227.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582391002899.PNG" alt=""></p>
<p>我這是很粗糙版本的，你可以多寫一個是否同意領取該道具，萬一玩家輸入錯誤就可以反悔。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服教學 - 如何新增全新的任務?(打怪/蒐集物品)]]></title>
        <id>https://Z1Nhouse.github.io//post/pv4fc18vn</id>
        <link href="https://Z1Nhouse.github.io//post/pv4fc18vn">
        </link>
        <updated>2020-02-22T13:35:31.000Z</updated>
        <content type="html"><![CDATA[<p>改任務只需要改到WZ，因此算是非常容易的。<br>
只要懂得每個節點之間的涵義就可以輕鬆的新增任務。<br>
本篇文章非常詳細的講解每個常用節點的意義，如果還是不會...我也沒辦法。</p>
<p>首先，打開你的Quest.wz，你可以看見<br>
<code>Act,Check,PQuest,Exclusive,QuestInfo,Say</code>　這幾個節點</p>
<p>PQ的是遠征隊的可以不去管它，新增任務常用到的只有其中四個節點：<code>Act、Check、QuestInfo、Say</code><br>
每一個各有它自己的功用，比如<strong>Act</strong>代表任務需要的物品、經驗、楓幣，以及任務完成之後獲得的獎勵；<br>
而<strong>Check</strong>則可以指定任務接取、完成的NPC以及檢查任務道具或者怪物擊殺數量是否正確；<br>
<strong>QuestInfo</strong>代表任務在任務欄裡頭顯示的文字；<br>
<strong>Say</strong>則是接任務以及回報任務時NPC所說的話。</p>
<h2 id="️act">⚠️ACT</h2>
<p>首先來看act：</p>
<p><strong>0代表未完成，1代表完成</strong></p>
<p>1 - exp 代表完成後可得到的經驗值<br>
1 - item 代表任務所需要的物品或者獎勵的物品</p>
<p>若你今天任務完成要給予玩家兩個道具，則要新增兩個節點(0,1)<br>
1 - item - 0<br>
1 - item - 1</p>
<p>而0,1底下還要再新增id與count，這邊沒有提到的prop則可以控制得到獎勵的機率。</p>
<p>id代表道具的代碼<br>
count代表數量，若是要從玩家那裡得到記得要加上負號</p>
<figure data-type="image" tabindex="1"><img src="https://Z1Nhouse.github.io//post-images/1582381147067.PNG" alt=""></figure>
<p>你可以先從幾個熟悉的任務開始研究其節點各自代表的含意，比如說我會拿&lt;證明本領-2&gt;(28222)這個任務來做研究，這個任務需要玩家蒐集20個(4000001)菇菇寶貝傘，完成後可以得到經驗值1600。<br>
PS.一個小技巧，你可以用編輯器打開<code>wz/Quest.wz/QuestInfo.img</code> 看看任務簡介來做參考。</p>
<h2 id="️check">⚠️CHECK</h2>
<p>再來說說Check，Check扮演了很重要的角色，</p>
<p><strong>0主要是處理「可接取對象的條件」</strong></p>
<p>0 - job 代表可以接取任務的職業<br>
0 - lvmax(lvmin) 代表可以接取任務的最低等級以及等級限制<br>
0 - npc 代表接取任務的NPC<br>
0 - quest 代表任務有沒有前置<br>
quest裡頭的id就是任務代碼</p>
<p><strong>1則是「接取任務後至結束」</strong></p>
<p>1 - item 代表任務所需的道具</p>
<ul>
<li>item - 0 第一個道具 (id,count)</li>
<li>item - 1 第二個道具 (id,count)<br>
...以此類推</li>
</ul>
<p>1 - npc 代表完成任務的NPC</p>
<figure data-type="image" tabindex="2"><img src="https://Z1Nhouse.github.io//post-images/1582381835841.PNG" alt=""></figure>
<h2 id="️quest-info">⚠️QUEST INFO</h2>
<p>QuestInfo就比較容易了，隨便點開一個任務看一下就知道每個節點的意義。</p>
<p>0 代表 任務在「可接取任務」欄位時顯示的內容<br>
1 代表 任務接取後在任務欄顯示的內容<br>
2 代表 任務完成後在「已完成任務」欄位顯示的內容</p>
<p>area代表任務屬於的類別<br>
目前知道的是10代表「職業」<br>
其他就自行研究了</p>
<p>demandSummary是在任務欄「任務需求」顯示的內容<br>
rewardSummary是在任務欄「任務獎勵」顯示的內容</p>
<p>name就是任務的名稱</p>
<figure data-type="image" tabindex="3"><img src="https://Z1Nhouse.github.io//post-images/1582380437039.PNG" alt=""></figure>
<h2 id="️say">⚠️Say</h2>
<p><strong>0代表未完成，1代表完成</strong></p>
<p>say方面我研究的不多，各位可以自己理解。<br>
是與NPC相關的部分。</p>
<figure data-type="image" tabindex="4"><img src="https://Z1Nhouse.github.io//post-images/1582382805930.PNG" alt=""></figure>
<p>要新增任務的話就新增Sub節點取一個沒用到的任務代碼即可。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服v120 新增 打怪掉點 功能]]></title>
        <id>https://Z1Nhouse.github.io//post/cb3av_hPP</id>
        <link href="https://Z1Nhouse.github.io//post/cb3av_hPP">
        </link>
        <updated>2020-02-20T14:32:31.000Z</updated>
        <content type="html"><![CDATA[<p>來自夢夢谷端口。<br>
很簡單，只需要改SRC，兩步驟就解決。</p>
<h2 id="改src">改SRC</h2>
<ol>
<li>打開<code>constants.ServerConstants.java</code></li>
</ol>
<p>搜索<code>//End of Poll</code> 下方加上：</p>
<pre><code>public static String 點數掉落 = &quot;1,3,15&quot;;
</code></pre>
<ol start="2">
<li>打開<code>server.maps.MapleMap.java</code></li>
</ol>
<p>在最開始import加上</p>
<pre><code>import constants.ServerConstants
</code></pre>
<p>在<code>dropFromMonster</code>函數的最後一個括號前加上：</p>
<pre><code>        int moblevel = mob.getStats().getLevel();
        int difference = chr.getLevel() &gt; 120 ? chr.getLevel() &gt; 150 ? 75 : 75 : 75;//相差等級
        boolean YesNo = (chr.getLevel() - moblevel) &lt;= difference;
        int Percentage = Randomizer.rand(1, 100);//轉換百分比
        int GetPoints = (int) Randomizer.rand(Integer.parseInt(ServerConstants.點數掉落.split(&quot;,&quot;)[0]), Integer.parseInt(ServerConstants.點數掉落.split(&quot;,&quot;)[1])); //最少1 最多3
        if (Percentage &lt; Integer.parseInt(ServerConstants.點數掉落.split(&quot;,&quot;)[2]) &amp;&amp; chr.getLevel() &gt; 10) { //隨機產生數由1~100 如果&lt;15 才會掉點
            if (YesNo) {
                chr.modifyCSPoints(2, GetPoints); //掉點類型 1為CASH 2為楓葉點數
                chr.dropMessage(-1, &quot;從怪物身上獲得了 &quot; + GetPoints + &quot; 楓葉點數&quot;);
            } else {
                chr.dropMessage(-1, &quot;與怪物等級相差大於 &quot; + difference + &quot; 故無法獲得點數。&quot;);
            }
        }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服 賭博JS(21點、倍數賭博機、比大小、踩地雷、老虎機)]]></title>
        <id>https://Z1Nhouse.github.io//post/5KthHuPnW</id>
        <link href="https://Z1Nhouse.github.io//post/5KthHuPnW">
        </link>
        <updated>2020-02-20T06:35:38.000Z</updated>
        <content type="html"><![CDATA[<p>這些資源是從對岸拿到的，我也不記得是從哪個拿的，就分享一下我比較常逛的論壇：<br>
<a href="https://www.fengyewuyu.com/">楓業物語論壇</a>與 <a href="https://bbs.ytmxd.com/forum-93-1.html">冒險島私服論壇</a><br>
我記得原本是可以輸入賭注的，但是我架的服輸入問題還沒解決，所以全部改為統一賭注，<br>
如果有需要輸入賭注的話可以自己修改掉。<br>
有一些已經很多人分享過了，我這邊就再貼一次順便加上一些註解</p>
<p>在開始之前先說幾個重點函數：</p>
<ol>
<li>Math.random() 函數隨機產生一數在範圍[0，1)，從0（包括0）往上，但是不包括1（排除1）。</li>
<li>Math.floor() 函式會回傳無條件捨去後的最大整數。<br>
其他可以參考<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript">MDN</a></li>
</ol>
<p>端口常用的函數：</p>
<ol>
<li>cm.getPlayer().getCSPoints(1)//判斷玩家GASH數 (1是GASH,2是楓葉點數</li>
<li>cm.getPlayer().modifyCSPoints(1, -50, true); //給予或扣除GASH</li>
<li>cm.haveItem(物品id,數);  //判断玩家背包是否有此道具</li>
<li>cm.gainItem(物品id,數);  //给予或者收取指定物品</li>
<li>cm.getPlayer().itemQuantity(物品id) //判斷玩家背包中這個物品有多少數</li>
<li>cm.getPlayer().getMeso() //判斷玩家楓幣數</li>
<li>cm.gainMeso(-10000000); //給予或扣除玩家楓幣</li>
<li>cm.getPlayer().getLevel() //判斷玩家等級</li>
<li>cm.worldMessage(6,&quot;公告&quot;); //6為藍字廣播,5為紅字廣播</li>
</ol>
<h2 id="21點">21點</h2>
<p><img src="https://Z1Nhouse.github.io//post-images/1582180727380.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582180730513.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582180733154.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582180735242.PNG" alt=""></p>
<p>JS</p>
<pre><code>/*
 * 賭博21点
 *
 *
 */

var text = &quot;&quot;;
var text1 = &quot;&quot;;
var score = 0;
var zhuangScore = 0;
var xianScore = 0;
var paiArray = Array(&quot;A&quot;, 2, 3, 4, 5, 6, 7, 8, 9, 10, &quot;J&quot;, &quot;Q&quot;, &quot;K&quot;);
var paiArray2 = Array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 10, 10, 10);
var ran = -1;


function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == -1) {
        cm.dispose();
    } else {
        if (status == 0 &amp;&amp; mode == 0) {

            cm.sendOk(&quot;歡迎下次光臨~&quot;);
            cm.dispose();
            return;
        }
        if (mode == 1) {
            status++;
        } else {
            if (status == 0) {
                cm.sendNext(&quot;歡迎下次光臨~&quot;);
                cm.dispose();
            }
            status--;
        }
        if (status == 0) {
            score = cm.getMeso();
            text += &quot;#fUI/UIWindow/Quest/icon3/6# &quot;;
            text += &quot;你好，在我這裡可以玩21點，一次#r50GASH#k哦。&quot;;
            text += &quot; #fUI/UIWindow/Quest/icon3/6#\r\n&quot;;
            text += &quot;#L0# 開始遊戲 #l\r\n&quot;;
            text += &quot;#L1# 遊戲說明 #l\r\n&quot;;
            cm.sendSimple(text);
        } else if (status == 1) {
            if (selection == 0) {
                cm.sendOk(&quot;賭友你要繼續下注嗎？&quot;);
            } else if (selection == 1) {
                text1 += &quot;#fUI/UIWindow/Quest/icon3/6# &quot;;
                text1 += &quot;玩法說明：&quot;;
                text1 += &quot; #fUI/UIWindow/Quest/icon3/6#\r\n&quot;;
                text1 += &quot;    莊家的點數會在15點-22點之間（#r莊家也有可能爆掉#k），你有4次要牌的機會，如果你的點數大於莊家的點數即贏得你下注的金額，如果大於21點或者小於等於莊家的點數，即輸掉你所下注的金額，10、J、Q、K都算十點，小賭怡情，大賭傷人，請慎重。&quot;;
                cm.sendOk(text1);
                cm.dispose();
            }
        }
        //-------------第一次要牌-----------------//
        else if (status == 2) {
            if (cm.getPlayer().getLevel() &lt; 70) {    //這邊可以設定玩家等級限制
                cm.sendOk(&quot;必須達到70級才能使用。&quot;);
                cm.dispose();
            } else if (cm.getPlayer().getCSPoints(1) &lt; 50) { //這邊可以設置賭注
                cm.sendOk(&quot;你沒有50GASH&quot;);
                cm.dispose();
            } else {
                cm.getPlayer().modifyCSPoints(1, -50, true);
                zhuangScore = parseInt(Math.random() * 8 + 15);
                ran = parseInt(Math.random() * paiArray.length);
                xianScore = paiArray2[ran];
                var text2 = &quot;&quot;;
                text2 += &quot;拿到了 #r#e&quot; + paiArray[ran] + &quot;#n#k,您目前的點數為： #r#e&quot; + xianScore + &quot;#n#k ，&quot;;
                text2 += &quot;您繼續要牌嗎？ \r\n&quot;;
                text2 += &quot;#L2# 要  \r\n&quot;;
                text2 += &quot;#L3# 不要  \r\n&quot;;
                cm.sendSimple(text2);
            }

        }

        //------------第二次要牌------------------//

        else if (status == 3) {
            if (selection == 2) {
                ran = parseInt(Math.random() * paiArray.length);
                xianScore += paiArray2[ran];
                if (xianScore &gt; 21) {
                    cm.sendOk(&quot;對不起，您的點數大於21點，您輸了。&quot;);
                    cm.dispose();
                } else {
                    text2 = &quot;&quot;;
                    text2 += &quot;拿到了 #r#e&quot; + paiArray[ran] + &quot;#n#k,您目前的點數為： #r#e&quot; + xianScore + &quot;#n#k ，&quot;;
                    text2 += &quot;您繼續要牌嗎？ \r\n&quot;;
                    text2 += &quot;#L4# 要  \r\n&quot;;
                    text2 += &quot;#L5# 不要  \r\n&quot;;
                    cm.sendSimple(text2);
                }
            } else if (selection == 3) {
                if ((xianScore &lt; 22 &amp;&amp; xianScore &lt;= zhuangScore &amp;&amp; zhuangScore &lt; 22) || (xianScore &gt;= 22 &amp;&amp; zhuangScore &gt;= 22)) {
                    cm.sendOk(&quot;莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您輸了。&quot;);
                    cm.dispose();
                } else {
                    cm.sendOk(&quot;#fUI/UIWindow/Quest/reward#\r\n  莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您贏了。&quot;);
                    cm.worldMessage(6,&quot;[賭博公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場二十一點贏了，將籌碼翻了【兩倍】獲得100點GASH!&quot;);
                    cm.getPlayer().modifyCSPoints(1, 100, true);
                    cm.gainItem(4031189,1); //這裡可以另外設定獎勵，不要的話可刪除
                    cm.dispose();
                }
            }


        }
        //-----------第三次要牌---------------
        else if (status == 4) {
            if (selection == 4) {
                ran = parseInt(Math.random() * paiArray.length);
                xianScore += paiArray2[ran];
                if (xianScore &gt; 21) {
                    cm.sendOk(&quot;對不起，您的點數大於21點，您輸了&quot;);
                    cm.dispose();
                } else {
                    text2 = &quot;&quot;;
                    text2 += &quot;拿到了 #r#e&quot; + paiArray[ran] + &quot;#n#k,您目前的點數為： #r#e&quot; + xianScore + &quot;#n#k ，&quot;;
                    text2 += &quot;您繼續要牌嗎？ \r\n&quot;;
                    text2 += &quot;#L6# 要  \r\n&quot;;
                    text2 += &quot;#L7# 不要  \r\n&quot;;
                    cm.sendSimple(text2);
                }
            } else if (selection == 5) {
                if ((xianScore &lt; 22 &amp;&amp; xianScore &lt;= zhuangScore &amp;&amp; zhuangScore &lt; 22) || (xianScore &gt;= 22 &amp;&amp; zhuangScore &gt;= 22)) {
                    cm.sendOk(&quot;莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您輸了。&quot;);
                    cm.dispose();
                } else {
                    cm.sendOk(&quot;#fUI/UIWindow/Quest/reward#\r\n  莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您贏了。&quot;);
                    cm.worldMessage(6,&quot;[賭博公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場二十一點贏了，將籌碼翻了【兩倍】獲得100點GASH!&quot;);
                    cm.getPlayer().modifyCSPoints(1,100, true);
                    cm.gainItem(4031189,1);
                    cm.dispose();
                }
            }


        }

        //--------第四次要牌----------
        else if (status == 5) {
            if (selection == 6) {
                ran = parseInt(Math.random() * paiArray.length);
                xianScore += paiArray2[ran];
                if (xianScore &gt; 21) {
                    cm.sendOk(&quot;對不起，您的點數大於21點，您輸了&quot;);
                    cm.dispose();
                } else {
                    if ((xianScore &lt; 22 &amp;&amp; xianScore &lt;= zhuangScore &amp;&amp; zhuangScore &lt; 22) || (xianScore &gt;= 22 &amp;&amp; zhuangScore &gt;= 22)) {
                        cm.sendOk(&quot;莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您輸了。&quot;);
                        cm.dispose();
                    } else {
                        cm.sendOk(&quot;#fUI/UIWindow/Quest/reward#\r\n  莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您贏了。&quot;);
                        cm.worldMessage(6,&quot;[賭博公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場二十一點贏了，將籌碼翻了【兩倍】獲得100點GASH!&quot;);
                        cm.getPlayer().modifyCSPoints(1, 100, true);
                        cm.gainItem(4031189,1);
                        cm.dispose();
                    }
                }

            } else if (selection == 7) {
                if ((xianScore &lt; 22 &amp;&amp; xianScore &lt;= zhuangScore &amp;&amp; zhuangScore &lt; 22) || (xianScore &gt;= 22 &amp;&amp; zhuangScore &gt;= 22)) {
                    cm.sendOk(&quot;莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您是輸了。&quot;);
                    cm.dispose();
                } else {
                    cm.sendOk(&quot;#fUI/UIWindow/Quest/reward#\r\n  莊家的點數為 #r#e&quot; + zhuangScore + &quot;#n#k,您的點數為 #r#e&quot; + xianScore + &quot;#n#k,您贏了。&quot;);
                    cm.worldMessage(6,&quot;[賭博公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場二十一點贏了，將籌碼翻了【兩倍】獲得100點GASH!&quot;);
                    cm.getPlayer().modifyCSPoints(1, 100, true);
                    cm.gainItem(4031189,1);
                    cm.dispose();
                }
            }
        }
    }
}
</code></pre>
<h2 id="十倍賭博機">十倍賭博機</h2>
<p>其實就只是一個靠運氣的機器，沒有什麼玩法。<br>
<img src="https://Z1Nhouse.github.io//post-images/1582181073121.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582181075673.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582181077807.PNG" alt=""><br>
這是贏的時候會有的廣播<br>
<img src="https://Z1Nhouse.github.io//post-images/1582181080251.PNG" alt=""></p>
<p>JS</p>
<pre><code>var status = 0;
var fee;
var chance = Math.floor(Math.random() * 12 + 1); //這裡可以設定機率

function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == -1) {
        cm.dispose();
    } else {
        if (mode == 0) {
            cm.sendOk(&quot;#i3994125# - 我會繼續在這裡等著你。&quot;);
            cm.dispose();
            return;
        }
        if (mode == 1)
            status++;
        else
            status--;
        if (status == 0) {
            cm.sendAcceptDecline(&quot;#r【十倍賭博機】\r\n#d-看來你的心很大啊，其他賭博機滿足不了你了嗎？#i3994125# #k\r\n &quot;);
        } else if (status == 1) {
            cm.sendOk(&quot;#i3994125#\r\n如果你能贏我，我會將你的籌碼數倍奉還，而且還有神秘禮品&quot;);
        } else if (status == 2) {
            fee = cm.getText();
            cm.sendYesNo(&quot;#i3994125# - 你確認要繼續下注嗎？一次消耗#r50GASH#k。&quot;);
        } else if (status == 3) {
            if (cm.getPlayer().getLevel() &lt; 70) {
                cm.sendOk(&quot;必須達到70級才能使用。&quot;);
                cm.dispose();
            } else if (cm.getPlayer().getCSPoints(1) &lt; 50) {
                cm.sendOk(&quot;你沒有50GASH&quot;);
                cm.dispose();
            } else {
                if (chance &lt;= 1) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;#i3994125# - #r你輸了#k&quot;);
                   // cm.worldMessage(6, &quot;[賭場公告]：玩家 &quot; + cm.getChar().getName() + &quot; ，在賭場十倍賭博機輸了，看來今天並不被女神眷顧!&quot;);
                    cm.dispose();
                } else if (chance == 2) {
                    cm.sendNext(&quot;#i3994125# - #r這把不算，重新再來，你手不要抖動。#k&quot;);
                    cm.dispose();
                } else if (chance == 3) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;#i3994125# - #r你輸了#k&quot;);
                    cm.dispose();
                } else if (chance == 4) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;#i3994125# - #r你輸了#k&quot;);
                    cm.dispose();
                } else if (chance == 5) {
                    cm.sendNext(&quot;#i3994125# - #r這把不算，重新再來，你手不要抖動。#k&quot;);
                    cm.dispose();
                } else if (chance == 6) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;#i3994125# - #r你輸了#k&quot;);
                    cm.dispose();
                } else if (chance == 7) {
                    cm.sendNext(&quot;#i3994125# - #r這把不算，重新再來，你手不要抖動。#k&quot;);
                    cm.dispose();
                } else if (chance == 8) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;#i3994125# - #r你輸了#k&quot;);
                    cm.dispose();
                } else if (chance == 9) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;#i3994125# - #r你輸了#k&quot;);
                    cm.dispose();
                } else if (chance == 10) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;#i3994125# - #r你輸了#k&quot;);
                    cm.dispose();
                } else if (chance == 11) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    cm.sendNext(&quot;哦··你的運氣不怎麼好哦··哈哈 再來一把嘛!&quot;);
                    cm.dispose();
                } else if (chance &gt;= 12) {
                    cm.getPlayer().modifyCSPoints(1, 500, true);
                    cm.gainItem(4031189,1);
                    cm.sendNext(&quot;#i3994125# -#r不錯哦，恭喜你贏了，我願賭服輸!獲得500點數&quot;);
                    cm.worldMessage(6,&quot;[賭場公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場十倍賭博機贏了，將籌碼翻了【十倍】獲得500點數!&quot;);
                    cm.dispose();
                }
            }
        }
    }
}
</code></pre>
<h2 id="比大小">比大小</h2>
<p><img src="https://Z1Nhouse.github.io//post-images/1582181213643.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582181219832.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582181222722.PNG" alt=""><br>
JS</p>
<pre><code>var status = 0;
//var 黑水晶 = 4021008;
//var 藍色箭頭 = &quot;#fUI/UIWindow/Quest/icon2/7#&quot;;
//var 紅色箭頭 = &quot;#fUI/UIWindow/Quest/icon6/7#&quot;;
//var 圓形 = &quot;#fUI/UIWindow/Quest/icon3/6#&quot;;
//var 美化new = &quot;#fUI/UIWindow/Quest/icon5/1#&quot;;
//var 驚嘆號 = &quot;#fUI/UIWindow/Quest/icon0#&quot;;
var 正方箭頭 = &quot;#fUI/Basic/BtHide3/mouseOver/0#&quot;;
/*以上都是小圖示路徑，用來裝飾的，可以修改*/
function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == -1) {
        cm.dispose();
    } else {
        if (status &gt;= 0 &amp;&amp; mode == 0) {
            cm.dispose();
            return;
        }
        if (mode == 1)
            status++;
        else
            status--;
        if (status == 0) {
            var a1 = &quot;#L1##b&quot; + 正方箭頭 + &quot; 50 GASH 【大】【小】\r\n&quot;;
            var a2 = &quot;#L2##b&quot; + 正方箭頭 + &quot; 250GASH 【大】【小】\r\n&quot;;
            var a3 = &quot;#L3##b&quot; + 正方箭頭 + &quot; 500GASH 【大】【小】\r\n&quot;;


            cm.sendSimple(&quot;\r\n#d-來來來，買大買小，買定離手#i3994122# #r【大小賭博機】\r\n#r  【賠率】1:2【概率】5:5\r\n&quot; + a1 + &quot;&quot; + a2 + &quot;&quot; + a3 + &quot;&quot;);

        } else if (selection == 1) {
            if (cm.getPlayer().getLevel() &lt; 70) {
                cm.sendOk(&quot;必須達到70級才能使用。&quot;);
                cm.dispose();
                return;
            } else {
                if (cm.getPlayer().getCSPoints(1) &gt;= 50) {
                    cm.getPlayer().modifyCSPoints(1, -50, true);
                    var rand = Math.floor(Math.random() * 100);
                    if (rand &lt; 50) {
                        cm.getPlayer().modifyCSPoints(1, 100, true);
                        cm.gainItem(4031189,1);
                        cm.sendOk(&quot;恭喜你，贏了&quot;);
                        cm.dispose();
                        cm.worldMessage(6,&quot;[賭場公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場選大小點贏了，將籌碼x1翻了【兩倍】獲得100點GASH!&quot;);
                        return;
                    } else {
                        cm.sendOk(&quot;唉，輸了&quot;);
                        cm.dispose();
                        return;
                    }
                } else {
                    cm.sendOk(&quot;你沒有足夠的GASH.~&quot;);
                    cm.dispose();
                    return;
                }
            }
        } else if (selection == 2) {
            if (cm.getPlayer().getLevel() &lt; 25) {
                cm.sendOk(&quot;必須達到25級才能使用。&quot;);
                cm.dispose();
                return;
            } else {

                if (cm.getPlayer().getCSPoints(1) &gt;= 250) {
                    cm.getPlayer().modifyCSPoints(1, -250, true);
                    var rand = Math.floor(Math.random() * 100);
                    if (rand &lt; 50) {
                        cm.getPlayer().modifyCSPoints(1, 500, true);
                        cm.gainItem(4031189,1);
                        cm.sendOk(&quot;恭喜你，贏了&quot;);
                        cm.dispose();
                        cm.worldMessage(6,&quot;[賭場公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場選大小點贏了，將籌碼x5翻了【兩倍】獲得500點GASH!&quot;);
                        return;
                    } else {
                        cm.sendOk(&quot;唉，輸了&quot;);
                        cm.dispose();
                        return;
                    }
                } else {
                    cm.sendOk(&quot;你沒有足夠的GASH~&quot;);
                    cm.dispose();
                    return;
                }
            }
        } else if (selection == 3) {
            if (cm.getPlayer().getLevel() &lt; 25) {
                cm.sendOk(&quot;必須達到25級才能使用。&quot;);
                cm.dispose();
                return;
            } else {
                if (cm.getPlayer().getCSPoints(1) &gt;= 500) {
                    cm.getPlayer().modifyCSPoints(1, -500, true);
                    var rand = Math.floor(Math.random() * 100);
                    if (rand &lt; 50) {
                        cm.getPlayer().modifyCSPoints(1, 1000, true);
                        cm.gainItem(4031189,1);
                        cm.sendOk(&quot;恭喜你，贏了&quot;);
                        cm.dispose();
                        cm.worldMessage(6,&quot;[賭場公告]：玩家 &quot; + cm.getPlayer().getName() + &quot; ，在賭場選大小點贏了，將籌碼x10翻了【兩倍】獲得1000點GASH!&quot;);
                        return;
                    } else {
                        cm.sendOk(&quot;唉，輸了&quot;);
                        cm.dispose();
                        return;
                    }
                } else {
                    cm.sendOk(&quot;你沒有足夠的GASH~&quot;);
                    cm.dispose();
                    return;
                }
            }
        }
    }
}
</code></pre>
<h2 id="踩地雷">踩地雷</h2>
<p><img src="https://Z1Nhouse.github.io//post-images/1582181391411.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582181395341.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582181398002.PNG" alt=""><br>
勝利的時候也會有時間顯示<br>
<img src="https://Z1Nhouse.github.io//post-images/1582181400378.PNG" alt=""><br>
JS</p>
<pre><code>var DEBUG = false;
var HIDDEN_ITEM = 4031325, MINE_ITEM = 5021013, EXPLODED_ITEM = 5120009;//這邊可以設定隱藏的圖示(HIDDEN_ITEM)、鞭炮的圖示(EXPLODED_ITEM)、地雷的圖示(MINE_ITEM)
var Modes = [
    [&quot;#d簡單#k&quot;, 5, 5, 4], //5*5 , 有3個地雷+1個鞭炮
    [&quot;#b中等#k&quot;, 6, 6, 8], //6*6 , 有7個地雷+1個鞭炮
    [&quot;#r困難#k&quot;, 7, 7, 15] //7*7 , 有14個地雷+1個鞭炮
];
var text = &quot;&quot;;

var status;
var Board, Revealed;
var VALUE_REVEALED = 1, VALUE_HIDDEN = 0;
var ModeSelected = -1, StartTime = -1, NumCols = -1,
        NumRows = -1, NumMines = -1, LeftToBeRevealed = -1;
var Neighbors = [
    [-1, -1], [-1, 0], [-1, 1], [0, -1],
    [0, 1], [1, -1], [1, 0], [1, 1]
];
var Numbers = [ //這邊可以設定數字的樣式,預設是裝飾聖誕樹的紅色數字
    3990009, 3990000, 3990001, 3990002, 3990003,
    3990004, 3990005, 3990006, 3990007, 3990008
];

function start() {
    status = -1;
    action(1, 0, 0);
}
function Header() {
    return &quot;#d============ 踩地雷 ============#k\r\n\r\n&quot;;
}
function ConstructModeSelectionString() {
    var ret = &quot;&quot;;
    for (var i = 0; i &lt; Modes.length; i++) {
        ret += &quot;#L&quot; + i + &quot;#&quot; + Modes[i][0] + &quot; (&quot; + Modes[i][1] + &quot;x&quot; + Modes[i][2] + &quot;) 地雷數: &quot; + Modes[i][3] + &quot;#l\r\n&quot;;
    }
    return ret;
}
function InitializeBoard() {

    NumCols = Modes[ModeSelected][1];
    NumRows = Modes[ModeSelected][2];

    NumMines = Modes[ModeSelected][3];

    LeftToBeRevealed = NumCols * NumRows - NumMines;
    if (LeftToBeRevealed == 21) {
        text = &quot;簡單模式&quot;;
    } else if (LeftToBeRevealed == 28) {
        text = &quot;中等模式&quot;;
    } else if (LeftToBeRevealed == 34) {
        text = &quot;困難模式&quot;;
    }
    Board = new Array(NumCols);
    for (var i = 0; i &lt; NumCols; i++) {
        Board[i] = new Array(NumRows);
    }
    Revealed = new Array(NumCols);
    for (i = 0; i &lt; NumCols; i++) {
        Revealed[i] = new Array(NumRows);
        for (var j = 0; j &lt; NumRows; j++) {
            Revealed[i][j] = VALUE_HIDDEN;
        }
    }
    InitializeMines();
    InitializeMineCounts();
    InitializeBlankSpaces();
}
function InitializeMines() {
    var AllPosition = new Array(NumRows * NumCols);
    for (var i = 0; i &lt; NumCols; i++) {
        for (var j = 0; j &lt; NumRows; j++) {
            AllPosition[(i * NumCols) + j] = [i, j];
        }
    }
    Shuffle(AllPosition);
    for (i = 0; i &lt; NumMines &amp;&amp; AllPosition.length &gt; 0; i++) {
        var NewMine = AllPosition.pop();
        Board[NewMine[0]][NewMine[1]] = MINE_ITEM;
    }
}
function InitializeMineCounts() {
    for (var r = 0; r &lt; NumCols; r++) {
        for (var c = 0; c &lt; NumRows; c++) {
            if (Board[r][c] != MINE_ITEM) {
                var Count = 0;
                for (var k = 0; k &lt; Neighbors.length; k++) {
                    var NewR = r + Neighbors[k][0];
                    var NewC = c + Neighbors[k][1]
                    if (ValidPosition(NewR, NewC) &amp;&amp; Board[NewR][NewC] == MINE_ITEM) {
                        Count++;
                    }
                }
                Board[r][c] = Numbers[Count];
            }
        }
    }
}
function InitializeBlankSpaces() {
    for (var i = 0; i &lt; NumCols; i++) {
        for (var j = 0; j &lt; NumRows; j++) {
            if (Board[i][j] == null) {
                Board[i][j] = HIDDEN_ITEM;
            }
        }
    }
}
function ConstructBoardString() {
    var ret = &quot;剩下的數字數目: &quot; + LeftToBeRevealed + &quot;\r\n&quot;;
    var num = 0;
    for (var i = 0; i &lt; NumCols; i++) {
        for (var j = 0; j &lt; NumRows; j++) {
            if (Revealed[i][j] == VALUE_REVEALED) {
                ret += &quot;#L&quot; + num + &quot;##v&quot; + Board[i][j] + &quot;##l&quot;;
            } else {
                if (DEBUG &amp;&amp; Board[i][j] == MINE_ITEM) {
                    ret += &quot;#L&quot; + num + &quot;##v&quot; + MINE_ITEM + &quot;##l&quot;;
                } else {
                    ret += &quot;#L&quot; + num + &quot;##v&quot; + HIDDEN_ITEM + &quot;##l&quot;;
                }
            }
            num++;
        }
        ret += &quot;\r\n&quot;;
    }
    return ret;
}
function ConstructEndBoardString() {
    var ret = &quot;&quot;;
    var num = 0;
    for (var i = 0; i &lt; NumCols; i++) {
        for (var j = 0; j &lt; NumRows; j++) {
            if (Revealed[i][j] == VALUE_REVEALED) {
                if (Board[i][j] == MINE_ITEM) {
                    ret += &quot;#v&quot; + EXPLODED_ITEM + &quot;#&quot;;
                } else {
                    ret += &quot;#v&quot; + Board[i][j] + &quot;#&quot;;
                }
            } else {
                if (Board[i][j] == MINE_ITEM) {
                    ret += &quot;#v&quot; + MINE_ITEM + &quot;#&quot;;
                } else {
                    ret += &quot;#v&quot; + HIDDEN_ITEM + &quot;#&quot;;
                }
            }
            num++;
        }
        ret += &quot;\r\n&quot;;
    }
    return ret;
}
function Shuffle(arr) {
    var i = arr.length;
    if (i == 0)
        return;
    while (--i) {
        var j = Math.floor(Math.random() * (i + 1));
        var tempi = arr[i];
        var tempj = arr[j];
        arr[i] = tempj;
        arr[j] = tempi;
    }
}
function ValidPosition(r, c) {
    return r &gt;= 0 &amp;&amp; r &lt; NumRows &amp;&amp; c &gt;= 0 &amp;&amp; c &lt; NumCols;
}
function GetPositionFromSelection(sel) {
    return [(sel / NumCols) | 0, (sel % NumCols) | 0];
}
function IsGameOver() {
    return LeftToBeRevealed == 0;
}
function GetGameTime(End) {
    var Diff = End - StartTime;
    var MilliSec = (Diff % 1000) | 0;
    Diff /= 1000;
    var Min = (Diff / 60) | 0;
    var Sec = (Diff % 60) | 0;
    return ((Min &lt; 10) ? &quot;0&quot; + Min : Min) + &quot;:&quot; + ((Sec &lt; 10) ? &quot;0&quot; + Sec : Sec)
            + &quot;.&quot; + ((MilliSec &lt; 100) ? &quot;0&quot; + ((MilliSec &lt; 10) ? &quot;0&quot; + MilliSec : MilliSec) : MilliSec);

}
function action(mode, type, selection) {
    if (mode == -1 || mode == 0)
        cm.dispose();
    else {
        if (status != 2)
            status++;

        if (status == 0) {
            cm.sendSimple(Header() + &quot;請選擇模式:\r\n&quot; + ConstructModeSelectionString())
        } else if (status == 1) {
            if (selection &lt; 0 || selection &gt; Modes.length) {
                cm.dispose();
                return;
            }
            ModeSelected = selection;
            InitializeBoard();
            cm.sendSimple(Header() + ConstructBoardString());
        } else if (status == 2) {
            if (StartTime == -1) {
                StartTime = (new Date()).getTime();
            }
            var SendStr = Header();
            var Move = GetPositionFromSelection(selection);
            if (!ValidPosition(Move[0], Move[1])) {
                cm.sendOk(&quot;PE Detected ...&quot;);
                return;
            }
            if (Revealed[Move[0]][Move[1]] == VALUE_REVEALED) {
                SendStr += &quot;該空格已被打開啟 ...\r\n\r\n&quot; + ConstructBoardString();
                cm.sendSimple(SendStr);
                return;
            }
            Revealed[Move[0]][Move[1]] = VALUE_REVEALED;
            LeftToBeRevealed--;
            SendStr += ConstructBoardString();
            if (Board[Move[0]][Move[1]] == MINE_ITEM) {
                cm.sendOk(Header() + ConstructEndBoardString() + &quot;\r\n你輸了!! 遊戲時間: &quot; + GetGameTime((new Date()).getTime()));
                cm.dispose();
            } else {
                if (IsGameOver()) {
                    cm.sendOk(Header() + ConstructEndBoardString() + &quot;\r\n你贏了!! 遊戲時間: &quot; + GetGameTime((new Date()).getTime()));
                    cm.worldMessage(6,&quot;『踩地雷小遊戲』：恭喜玩家:&quot; + cm.getPlayer().getName() + &quot; 花費: &quot; + GetGameTime((new Date()).getTime()) + &quot; 成功完成了&quot; + text + &quot;的踩地雷!!!&quot;);
                    cm.getPlayer().modifyCSPoints(1, 200, true);
                    cm.gainItem(4031189,1);
                    cm.dispose();
                } else {
                    cm.sendSimple(SendStr);
                }
            }
        }
    }
}  
</code></pre>
<h2 id="老虎機">老虎機</h2>
<p><img src="https://Z1Nhouse.github.io//post-images/1582182104809.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582182107636.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1582182112209.PNG" alt=""><br>
這個本來也是下賭注的，但我一樣把它改成固定金額1000w</p>
<p>JS</p>
<pre><code>/*老虎機*/

var status = 0;
var fee;
var winner;
var item=4021000;

var card1 = Math.floor(Math.random()*8+item);
var card2 = Math.floor(Math.random()*8+item);
var card3 = Math.floor(Math.random()*8+item);
var card4 = Math.floor(Math.random()*8+item);
var card5 = Math.floor(Math.random()*8+item);
var card6 = Math.floor(Math.random()*8+item);
var card7 = Math.floor(Math.random()*8+item);
var card8 = Math.floor(Math.random()*8+item);
var card9 = Math.floor(Math.random()*8+item);
/*這台老虎機是用各類水晶來遊戲的，從4021000(石榴石)-4021007(鑽石)*/

function start() {
status = -1;
action(1, 0, 0);
}

function action(mode, type, selection) {

if (mode == -1) {
cm.dispose();
} else {
if (mode == 0) {
cm.sendOk(&quot;你的損失。你或許可以贏得大錢。&quot;);
cm.dispose();
return;
}

if (mode == 1)
status++;
else
status--;

if (status == 0) {
cm.sendNext(&quot;你想玩#b老虎機#k嗎? 這個機台是六倍的賠率喔!!\r\n#v4021000##v4021001##v4021002##v4021003##v4021004##v4021005##v4021006##v4021007#寶石連線，就可獲勝&quot;);
} else if (status == 1) {
fee = 10000000;
cm.sendYesNo(&quot;你確定要下注 #r&quot; + fee + &quot;#k 楓幣嗎?... &quot;);
} else if (status == 2) {
if (cm.getMeso() &lt; fee) {
cm.sendOk(&quot;你沒有那麼多錢&quot;);
cm.dispose();
} else if (cm.getMeso() + fee * 6 &gt; 2100000000) {
cm.sendOk(&quot;如果你贏了這一把，身上的錢會超過21億，請先將金錢存放至倉庫。&quot;);
cm.dispose();
} else { //這邊是判斷連線的部分
if (card1 == card2 &amp;&amp; card2 == card3) {
winner = 1;
} else if (card1 == card5 &amp;&amp; card5 == card9) {
winner = 1;
} else if (card4 == card5 &amp;&amp; card5 == card6) {
winner = 1;
} else if (card7 == card8 &amp;&amp; card8 == card9) {
winner = 1;
} else if (card7 == card5 &amp;&amp; card5 == card3) {
winner = 1;
} else if (card1 == card4 &amp;&amp; card4 == card7) {
winner = 1;
} else if (card2 == card5 &amp;&amp; card5 == card8) {
winner = 1;
} else if (card3 == card6 &amp;&amp; card6 == card9) {
winner = 1;
} else {
winner = 2;
}

if (winner == 1) {

cm.sendOk(&quot;老虎機: \r\n\r\n#v&quot; +
card1 + &quot;##v &quot; + card2 + &quot;##v &quot; + card3 + &quot;# \r\n#v&quot; +
card4 + &quot;##v &quot; + card5 + &quot;##v &quot; + card6 + &quot;# \r\n#v&quot; +
card7 + &quot;##v &quot; + card8 + &quot;##v &quot; + card9 +
&quot;#\r\n\r\n 恭喜！你贏了！&quot;);

cm.gainMeso(fee * 6); //這裡設定獎勵
cm.gainItem(4031189,1);
cm.dispose();

} else if (winner == 2) {

cm.sendOk(&quot;老虎機: \r\n\r\n#v&quot; +
card1 + &quot;##v &quot; + card2 + &quot;##v &quot; + card3 + &quot;# \r\n#v&quot; +
card4 + &quot;##v &quot; + card5 + &quot;##v &quot; + card6 + &quot;# \r\n#v&quot; +
card7 + &quot;##v &quot; + card8 + &quot;##v &quot; + card9 +
&quot;#\r\n\r\n 你輸了！再接再厲！&quot;);

cm.gainMeso(-fee);
cm.dispose();

} else {
cm.dispose();
}
}
}
}
}

</code></pre>
<p>大概就是這樣，能隨意更改的部分我大多都有標上註解，當然，只要有創意怎麼改都行。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服v120 技能0CD/範圍擴大/數量增加/攻擊次數增加...]]></title>
        <id>https://Z1Nhouse.github.io//post/v-am4i5fY</id>
        <link href="https://Z1Nhouse.github.io//post/v-am4i5fY">
        </link>
        <updated>2020-02-16T17:31:29.000Z</updated>
        <content type="html"><![CDATA[<p>暫時只放演示，以下GIF無加速，皆為原速。</p>
<ul>
<li>
<p>天怒 全圖+施放延遲時間縮短<br>
<img src="https://upload.cc/i1/2020/02/17/zZlbQV.gif" alt=""></p>
</li>
<li>
<p>龍咆哮 全圖+延遲時間縮短<br>
<img src="https://media.giphy.com/media/MdGVtWG4nCTuMQWBfb/giphy.gif" alt=""></p>
</li>
<li>
<p>閃連殺 次數由6下改為12下<br>
<img src="https://media.giphy.com/media/RJEJs7CaWSNs6q7q93/giphy.gif" alt=""></p>
</li>
<li>
<p>魔龍降臨 數量由6隻改為12隻<br>
<img src="https://media.giphy.com/media/LrRMuYsrAjZLLUTMKC/giphy.gif" alt=""></p>
</li>
</ul>
<p>暫時只改了這些，其他有想玩的職業再改。<br>
只需要改Skill.wz與Character.wz就好，等哪天心情好了再放教程。</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服v120 中文化101時空的裂縫]]></title>
        <id>https://Z1Nhouse.github.io//post/NyJ2cyQTk</id>
        <link href="https://Z1Nhouse.github.io//post/NyJ2cyQTk">
        </link>
        <updated>2020-02-13T18:25:37.000Z</updated>
        <content type="html"><![CDATA[<p>涉及相關NPC與地圖代碼：</p>
<p><strong>愛奧斯塔101樓 221024500</strong><br>
NPC標示牌 2040034</p>
<p><strong>第一關 玩偶之家 922010100</strong><br>
紅氣球2040036<br>
士兵安德森2040047</p>
<p><strong>第二關 遺棄之塔 922010200</strong><br>
橘氣球2040037</p>
<p><strong>第三關 遺棄之塔 922010300</strong><br>
黃氣球2040038</p>
<p><strong>第四關 遺棄之塔 922010400</strong><br>
黃綠氣球 2040039</p>
<p><strong>第五關 遺棄之塔 922010500</strong><br>
綠氣球 2040040</p>
<p><strong>第六關 遺棄之塔 922010600</strong><br>
海藍氣球 2040041</p>
<p><strong>第七關 遺棄之塔 922010700</strong><br>
天藍氣球 2040042</p>
<p><strong>第八關 遺棄之塔 922010800</strong><br>
藍氣球 2040043</p>
<p><strong>第九關 時空的裂縫 922010900</strong><br>
紫氣球 2040044</p>
<p><strong>Bonus 922011000</strong><br>
粉紅氣球 2040045</p>
<h2 id="bug">BUG</h2>
<p>優化最終Bonus關卡可以點擊NPC離開地圖，但是獎品就要另外設置了。</p>
<p>以下是所有關卡NPC JS腳本的檔案下載：<a href="http://www.funp.net/683502">Download</a><br>
附上LudiPQ的Event：<a href="http://www.funp.net/833496">Download</a></p>
<h2 id="圖片示意">圖片示意</h2>
<p><img src="https://Z1Nhouse.github.io//post-images/1581868674986.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868677602.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868680228.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868682413.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868684612.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868689862.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868687475.PNG" alt=""></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服v120 點裝附魔系統]]></title>
        <id>https://Z1Nhouse.github.io//post/ttJAM9tXu</id>
        <link href="https://Z1Nhouse.github.io//post/ttJAM9tXu">
        </link>
        <updated>2020-01-31T16:25:01.000Z</updated>
        <content type="html"><![CDATA[<p><img src="https://Z1Nhouse.github.io//post-images/1580488136327.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1580488139108.PNG" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1580488141737.PNG" alt=""></p>
<h2 id="src">SRC</h2>
<ol>
<li>打開<code>scripting\NPCConversationManager.java</code> 在最下方}前加上：<br>
仔細看，裡頭可以修改附魔的能力，按照個人喜好設定。</li>
</ol>
<pre><code class="language-java">//點裝附魔
   public String EnchantCashEqip(byte slot) {
        Equip item = (Equip) c.getPlayer().getInventory(MapleInventoryType.EQUIP).getItem(slot);
        Equip sel = (Equip) item;
        int itemid = c.getPlayer().getInventory(MapleInventoryType.EQUIP).getItem(slot).getItemId();
        boolean isCash = MapleItemInformationProvider.getInstance().isCash(itemid);
        String msg = &quot;&quot;;

        if (isCash) {
            msg += &quot;您此次所附魔的點裝為#b#z&quot; + itemid + &quot;##k\r\n&quot;;
            msg += &quot;您此次的附魔為:\r\n&quot;;
            msg += &quot;－－－－－－－－－－－－－－－－－－－－－－－\r\n&quot;;

            short Str = (short) Randomizer.rand(5, 10);
            sel.setStr((short) (sel.getStr() + Str));
            msg += &quot;力量 +&quot; + &quot; &quot; + Str + &quot;\r\n&quot;;

            short Dex = (short) Randomizer.rand(5, 10);
            sel.setDex((short) (sel.getDex() + Dex));
            msg += &quot;敏捷: &quot; + &quot; &quot; + Dex + &quot;\r\n&quot;;

            short Int = (short) Randomizer.rand(5, 10);
            sel.setInt((short) (sel.getInt() + Int));
            msg += &quot;智力: &quot; + &quot; &quot; + Int + &quot;\r\n&quot;;

            short Luk = (short) Randomizer.rand(5, 10);
            sel.setLuk((short) (sel.getLuk() + Luk));
            msg += &quot;幸運: &quot; + &quot; &quot; + Luk + &quot;\r\n&quot;;

            short Watk = (short) Randomizer.rand(5, 10);
            sel.setWatk((short) (sel.getWatk() + Watk));
            msg += &quot;物理攻擊: &quot; + &quot; &quot; + Watk + &quot;\r\n&quot;;

            short Matk = (short) Randomizer.rand(5, 10);
            sel.setMatk((short) (sel.getMatk() + Matk));
            msg += &quot;魔法攻擊: &quot; + &quot; &quot; + Matk + &quot;\r\n&quot;;
            msg += &quot;－－－－－－－－－－－－－－－－－－－－－－－\r\n&quot;;
            msg += &quot;請問您是否要繼續附魔?\r\n#d[點選#r是#d,繼續附魔] [點選#r否#d,存取目前附魔]\r\n#d若裝備素質未改變,請重新登入或換頻即可生效!&quot;;
            int used = StringTool.getIntFromString(sel.getOwner());
            used++;
            sel.setOwner(&quot;已附魔&quot; + used + &quot;次&quot;);
            item = (Equip) sel.copy();
            MapleInventoryManipulator.removeFromSlot(getClient(), MapleInventoryType.EQUIP, (short) slot, item.getQuantity(), false);
            MapleInventoryManipulator.addFromDrop(getClient(), item, false);
            c.getPlayer().equipChanged();
            return msg;
        } else {
            return &quot;此裝備並非點裝唷!僅有點裝才可以附魔~&quot;;
        }
    }
</code></pre>
<h2 id="npc腳本">NPC腳本</h2>
<p>隨便找一個NPC塞下方的腳本：</p>
<pre><code class="language-javascript">load('nashorn:mozilla_compat.js');
importPackage(java.lang);
var status = -1;
var slot = Array();
var sel;
var item = 4001126; //

function start() {
    //status = -1;
    action(1, 0, 0);
}
var icon01 = &quot;#fUI/UIWindow.img/CashTradingRoom/BtCoin/normal/0#&quot;;
var icon02 = &quot;#fUI/UIWindow.img/UserInfo/bossPetCrown#&quot;;
var icon03 = &quot;#fUI/UIWindow.img/AriantMatch/characterIcon/0#&quot;;
var icon04 = &quot;#fUI/UIWindow.img/AriantMatch/characterIcon/1#&quot;;
var icon05 = &quot;#fUI/UIWindow.img/AriantMatch/characterIcon/2#&quot;;
var icon06 = &quot;#fUI/UIWindow.img/AriantMatch/characterIcon/3#&quot;;
var icon07 = &quot;#fUI/UIWindow.img/AriantMatch/characterIcon/4#&quot;;
var icon08 = &quot;#fUI/UIWindow.img/AriantMatch/characterIcon/5#&quot;;
var icon09 = &quot;#fUI/UIWindow.img/Megaphone/0#&quot;;
var icon10 = &quot;#fUI/UIWindow.img/CashTradingRoom/icon1#&quot;;

var status = -1;

function action(mode, type, selection) {
    if (mode == 0 &amp;&amp; status == 0) {
        cm.dispose();
        return;
    }
    if (mode == 1) {
        status++;
    } else {
        status--;
    }
    if (status == 0) {
        cm.sendSimple(
		&quot;#b請問您是否要使用點裝附魔功能呢?#d&quot;+	
		&quot;\r\n\r\n#L1#附魔一次需要使用#r#z&quot;+item+&quot;##k#d350個!#l&quot;
		);
    } else if (status == 1) {
		sel = selection;
        var avail = &quot;&quot;;
        for (var i = 0; i &lt; 96; i++) {
            if (cm.getInventory(1).getItem(i) != null) {
                if (Packages.server.MapleItemInformationProvider.getInstance().isCash(cm.getInventory(1).getItem(i).getItemId())) {
                    avail += &quot;#L&quot; + Math.abs(i) + &quot;##z&quot; + cm.getInventory(1).getItem(i).getItemId() + &quot;##l\r\n&quot;;
                }
            }
        }
        if(avail == &quot;&quot;){
             avail += &quot;很抱歉,您的裝備欄沒有任何的點裝哦!!~&quot;;    
            }
        cm.sendSimple(&quot;想要附魔哪一件點數裝備呢？？\r\n#b&quot; + avail);
    } else if (status == 2) {
        selected = selection;
        cm.sendYesNo(&quot;你想要附魔的點裝是 #b#t&quot; + cm.getInventory(1).getItem(selected).getItemId() + &quot;##k.\r\n您確定要對此點裝賦魔？？\r\n&quot;);
    } else if (status == 3) {
		var type ;
        if (cm.haveItem(item, 350)) {
            status = 5;
            cm.sendYesNo(cm.EnchantCashEqip(selected));
			cm.gainItem(item,-350);
        } else {
            status = 3;
            cm.sendOk(&quot;您的#b#z&quot; + item + &quot;##k不足哦!!&quot;);

        }
    } else if (status == 4) {
        //cm.getPlayer().fakeRelog();
        cm.dispose();

    } else if (status == 6) {
        status = 2;
        cm.sendOk(&quot;即將花費#b#z&quot;+item+&quot;##k350個重新附魔此點裝...&quot;);
    }
    
    }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服v120 當前地圖怪物掉寶查詢]]></title>
        <id>https://Z1Nhouse.github.io//post/6o_CeDq_a</id>
        <link href="https://Z1Nhouse.github.io//post/6o_CeDq_a">
        </link>
        <updated>2020-01-31T15:58:15.000Z</updated>
        <content type="html"><![CDATA[<p>照樣是搬來的，製作是彩虹工作室，但不記得從哪扒來的。<br>
<img src="https://Z1Nhouse.github.io//post-images/1580486644944.PNG" alt=""></p>
<h2 id="改src">改SRC</h2>
<p>其實應該看著NPC腳本就會知道怎麼改了...<br>
腳本的getAllMonstersThreadsafe是原端自帶<br>
真正要加的是getAllUniqueMonsters、checkMapDrop以及checkDrop函數</p>
<ol>
<li>打開<code>Sever\Maps\MapleMap.java</code><br>
在一串變數宣告下方貼上</li>
</ol>
<pre><code class="language-java">public List&lt;Integer&gt; getAllUniqueMonsters() {
        ArrayList&lt;Integer&gt; ret = new ArrayList&lt;&gt;();
        mapobjectlocks.get(MapleMapObjectType.MONSTER).readLock().lock();
        try {
            for (MapleMapObject mmo : mapobjects.get(MapleMapObjectType.MONSTER).values()) {
                int theId = ((MapleMonster) mmo).getId();
                if (!ret.contains(theId)) {
                    ret.add(theId);
                }
            }
        } finally {
            mapobjectlocks.get(MapleMapObjectType.MONSTER).readLock().unlock();
        }
        return ret;
    }

    /*怪物查詢*/
    private Map&lt;Integer, MapleMapObject&gt; mapobjects1 = new LinkedHashMap&lt;Integer, MapleMapObject&gt;();

    public Collection&lt;MapleMapObject&gt; getMapObjects() {
        return Collections.unmodifiableCollection(mapobjects1.values());
    }

    public List&lt;Integer&gt; getUniqueMonsters() {
        List&lt;Integer&gt; mobs = new ArrayList&lt;Integer&gt;();
        for (MapleMapObject obj : this.getMapObjects()) {
            MapleMonster mob = this.getMonsterByOid(obj.getObjectId());
            if (mob != null) {
                if (!mobs.contains(mob.getId())) {
                    mobs.add(mob.getId());
                }
            }
        }
        return mobs;
    }
</code></pre>
<ol start="2">
<li>打開<code>scripting\NPCConversationManager.java</code></li>
</ol>
<p>在最下方}前貼上</p>
<pre><code class="language-java">public String checkDrop(int mobId) {
        MapleItemInformationProvider ii = MapleItemInformationProvider.getInstance();
        List&lt;MonsterDropEntry&gt; ranks = MapleMonsterInformationProvider.getInstance().retrieveDrop(mobId);
        if (!ranks.isEmpty() &amp;&amp; ranks.size() &gt; 0) {
            int num = 0, itemId, chance;
            MonsterDropEntry de;
            StringBuilder name = new StringBuilder();
            for (MonsterDropEntry rank : ranks) {
                de = rank;
                if (de.chance &gt; 0 &amp;&amp; (de.questid &lt;= 0 || (de.questid &gt; 0 &amp;&amp; MapleQuest.getInstance(de.questid).getName().length() &gt; 0))) {
                    itemId = de.itemId;
                    if (itemId == 0) {
                        continue;
                    } else if (!ii.itemExists(itemId)) {
                        continue;
                    }
                    if (num == 0) {
                        name.append(&quot;當前怪物 #o&quot;).append(mobId).append(&quot;# 的掉寶率為:\r\n&quot;);
                        name.append(&quot;--------------------------------------\r\n&quot;);
                    }
                    String namez = &quot;&quot;;
                    if (itemId == 0) { //金幣 物品ID為0就是金幣道具
                        itemId = 4031041; //休咪的錢包 display sack of cash
                        namez = (de.Minimum * getClient().getChannelServer().getMesoRate()) + &quot; - &quot; + (de.Maximum * getClient().getChannelServer().getMesoRate()) + &quot; 的金幣&quot;;
                    } else {
                        namez = &quot;#z&quot; + itemId + &quot;#&quot;;
                    }
                    chance = de.chance * getClient().getChannelServer().getDropRate();
                    if (getPlayer().isAdmin()) {
                        name.append(num + 1).append(&quot;) #v&quot;).append(itemId).append(&quot;#&quot;).append(namez).append(&quot; - &quot;).append(Integer.valueOf(chance &gt;= 999999 ? 1000000 : chance).doubleValue() / 10000.0).append(&quot;%的掉寶率. &quot;).append(de.questid &gt; 0 &amp;&amp; MapleQuest.getInstance(de.questid).getName().length() &gt; 0 ? (&quot;需要接受任務: &quot; + MapleQuest.getInstance(de.questid).getName()) : &quot;&quot;).append(&quot;\r\n&quot;);
                    } else {
                        name.append(num + 1).append(&quot;) #v&quot;).append(itemId).append(&quot;#&quot;).append(namez).append(de.questid &gt; 0 &amp;&amp; MapleQuest.getInstance(de.questid).getName().length() &gt; 0 ? (&quot;需要接受任務: &quot; + MapleQuest.getInstance(de.questid).getName()) : &quot;&quot;).append(&quot;\r\n&quot;);
                    }
                    num++;
                }
            }
            if (name.length() &gt; 0) {
                return name.toString();
            }
        }
        return &quot;沒有找到這個怪物的掉寶率數據。&quot;;
    }

     public String checkMapDrop() {
        List&lt;MonsterGlobalDropEntry&gt; ranks = new ArrayList&lt;&gt;(MapleMonsterInformationProvider.getInstance().getGlobalDrop());
        int mapid = getPlayer().getMap().getId();
//        int cashServerRate = getClient().getChannelServer().getCashRate(); //點卷掉寶率
        //int globalServerRate = getClient().getChannelServer().getDropgRate(); //特殊數據庫道具掉寶率
        int globalServerRate = 1; //特殊數據庫道具掉寶率
        if (ranks != null &amp;&amp; ranks.size() &gt; 0) {
            int num = 0, itemId, chance;
            MonsterGlobalDropEntry de;
            StringBuilder name = new StringBuilder();
            for (MonsterGlobalDropEntry rank : ranks) {
                de = rank;
                if (de.continent &lt; 0 || (de.continent &lt; 10 &amp;&amp; mapid / 100000000 == de.continent) || (de.continent &lt; 100 &amp;&amp; mapid / 10000000 == de.continent) || (de.continent &lt; 1000 &amp;&amp; mapid / 1000000 == de.continent)) {
                    itemId = de.itemId;
                    if (num == 0) {
                        name.append(&quot;當前地圖 #r&quot;).append(mapid).append(&quot;#k - #m&quot;).append(mapid).append(&quot;# 的全局掉寶率為:&quot;);
                        name.append(&quot;\r\n--------------------------------------\r\n&quot;);
                    }
                    String names = &quot;#z&quot; + itemId + &quot;#&quot;;
//                    if (itemId == 0 &amp;&amp; cashServerRate != 0) {
//                        itemId = 4031041;
//                        names = (de.minimum * cashServerRate) + &quot; - &quot; + (de.maximum * cashServerRate) + &quot; 的抵用卷&quot;;
//                    }
                    chance = de.chance * globalServerRate;
                    if (getPlayer().isAdmin()) {
                        name.append(num + 1).append(&quot;) #v&quot;).append(itemId).append(&quot;#&quot;).append(names).append(&quot; - &quot;).append(Integer.valueOf(chance &gt;= 999999 ? 1000000 : chance).doubleValue() / 10000.0).append(&quot;%的掉寶率. &quot;).append(de.questid &gt; 0 &amp;&amp; MapleQuest.getInstance(de.questid).getName().length() &gt; 0 ? (&quot;需要接受任務: &quot; + MapleQuest.getInstance(de.questid).getName()) : &quot;&quot;).append(&quot;\r\n&quot;);
                    } else {
                        name.append(num + 1).append(&quot;) #v&quot;).append(itemId).append(&quot;#&quot;).append(names).append(de.questid &gt; 0 &amp;&amp; MapleQuest.getInstance(de.questid).getName().length() &gt; 0 ? (&quot;需要接受任務: &quot; + MapleQuest.getInstance(de.questid).getName()) : &quot;&quot;).append(&quot;\r\n&quot;);
                    }
                    num++;
                }
            }
            if (name.length() &gt; 0) {
                return name.toString();
            }
        }
        return &quot;當前地圖沒有設置全局掉寶率。&quot;;
    }
</code></pre>
<h2 id="npc腳本">NPC腳本</h2>
<p>隨便塞給一個NPC就行</p>
<pre><code class="language-javascript">/*
	製作：彩虹工作室
	功能：查看地圖怪物爆率
	時間：2016年12月23日
*/

var status = -1;

function action(mode, type, selection) {
    if (mode == 1) {
        status++;
    } else {
        if (status == 0) {
            cm.dispose();
        }
        status--;
    }
    if (status == 0) {
        if (cm.getMap().getAllMonstersThreadsafe().size() &lt;= 0) {
            cm.sendOk(&quot;當前地圖沒有刷新怪物，無法查看怪物掉寶資訊。&quot;);
            cm.dispose();
            return;
        }
        var selStr = &quot;請選擇你要查看怪物的掉寶資訊。\r\n\r\n#b&quot;;
        var iz = cm.getMap().getAllUniqueMonsters().iterator();
        while (iz.hasNext()) {
            var zz = iz.next();
            selStr += &quot;#L&quot; + zz + &quot;##o&quot; + zz + &quot;##l\r\n&quot;;
        }
        if (cm.getPlayer().isAdmin()) {
            selStr += &quot;\r\n#L0# #r查看全地圖掉寶資訊#k#l&quot;;
        }
        cm.sendSimple(selStr);
    } else if (status == 1) {
        if (selection == 0) {
            cm.sendNext(cm.checkMapDrop());
        } else {
             cm.sendOk(cm.checkDrop(selection));
        }
        cm.dispose();
    }
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服v120 每日簽到系統]]></title>
        <id>https://Z1Nhouse.github.io//post/Kfyq7c531</id>
        <link href="https://Z1Nhouse.github.io//post/Kfyq7c531">
        </link>
        <updated>2020-01-31T15:19:48.000Z</updated>
        <content type="html"><![CDATA[<p>夢夢谷端口扒來的。<br>
時間有點久遠，如果有哪裡漏掉了import還是什麼的...請自行補上吧。</p>
<p>簽到成功<br>
<img src="https://Z1Nhouse.github.io//post-images/1580485049904.PNG" alt=""><br>
簽到過或者時長不足<br>
<img src="https://Z1Nhouse.github.io//post-images/1580485053777.PNG" alt=""><br>
簽到後會在資料表中自動寫入今天日期以及簽到的帳號id。</p>
<hr>
<h2 id="️新建資料表">❗️新建資料表</h2>
<ol>
<li>首先，在資料庫新增一個資料表<code>prizelog_n</code>：</li>
</ol>
<ul>
<li>id/int/10/勾選主索引鍵/自動遞增</li>
<li>accid/int/10</li>
<li>bossid/varchar/20/字元集:utf8 整理:utf8_general_ci</li>
</ul>
<figure data-type="image" tabindex="1"><img src="https://Z1Nhouse.github.io//post-images/1580484064199.PNG" alt=""></figure>
<ol start="2">
<li>再新增第二個資料表<code>accounts_event</code>：<br>
直接用sql語法新增，或者參考語法手動新增。</li>
</ol>
<pre><code>CREATE TABLE `accounts_event` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `accId` int(11) NOT NULL DEFAULT '0',
  `eventId` varchar(20) NOT NULL DEFAULT '',
  `count` int(11) NOT NULL DEFAULT '0',
  `type` int(11) NOT NULL DEFAULT '0',
  `updateTime` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `accid` (`accId`),
  KEY `eventid` (`eventId`) 
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=big5;
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://Z1Nhouse.github.io//post-images/1582208152754.PNG" alt=""></figure>
<hr>
<h2 id="️改src">❗️改SRC</h2>
<p>▶️1. 打開<code>client\MapleCharacter.java</code>，在最後一個}前貼上：</p>
<pre><code class="language-java">public int getPrizeLog_n(String bossid) {
        Connection con1 = DatabaseConnection.getConnection();
        try {
            int ret_count = 0;
            PreparedStatement ps;
            ps = con1.prepareStatement(&quot;select count(*) from prizelog_n where accid = ? and bossid = ?&quot;);
            ps.setInt(1, getClient().getAccID());
            ps.setString(2, bossid);
            ResultSet rs = ps.executeQuery();
            if (rs.next()) {
                ret_count = rs.getInt(1);
            } else {
                ret_count = -1;
            }
            rs.close();
            ps.close();
            return ret_count;
        } catch (Exception Wx) {
            return -1;
        }
    }
    
public void setPrizeLog_n(String bossid) {
       Connection con1 = DatabaseConnection.getConnection();
        try {
            PreparedStatement ps;
            ps = con1.prepareStatement(&quot;insert into prizelog_n (accid, bossid) values (?,?)&quot;);
            ps.setInt(1, getClient().getAccID());
            ps.setString(2, bossid);
            ps.executeUpdate();
            ps.close();
        } catch (Exception Wx) {
        }
    }
</code></pre>
<p><strong>📣PS.如果你的端口已經有prizelog函數，此步驟可以跳過。</strong></p>
<p>▶️2. 同樣是<code>MapleCharacter.java</code></p>
<p>在最上方一堆變數宣告加上以下變數宣告</p>
<pre><code class="language-java">private long logintime;//登入時間
private long onlineTime;//上線時間
//角色一些特殊變量數據
private Timestamp todayonlinetimestamp;
</code></pre>
<p>在最後一個} 前加上</p>
<pre><code class="language-java">/*
     * OnlineTime 系統
     */
    public void initOnlineTime() {
        onlineTime = getEventCount(&quot;OnlineTime&quot;, 0);
    }

    //獲得在線時間
    public int getOnlineTime() {
        long l2;
        long l3 = getDaybyDay(1).getTimeInMillis() - getLogintime();
        if (onlineTime &lt; 0) {
            resetEventCount(&quot;OnlineTime&quot;, 0);
            initOnlineTime();
        }
        if (l3 &gt;= 86400000) {//86400000 = 一天毫秒
            l2 = getDaybyDay(1).getTimeInMillis() - 86400000;
            setLogintime(getDaybyDay(0).getTimeInMillis());
        } else {
            l2 = getLogintime() - onlineTime;
        }
        return (int) (System.currentTimeMillis() - l2);
    }

    public void setOnlineTime() {
        if (getLogintime() &gt; 0) {
            long l2 = getDaybyDay(1).getTimeInMillis() - getLogintime();
            if (onlineTime &lt; 0) {
                resetEventCount(&quot;OnlineTime&quot;, 0);
            }
            setEventCount(&quot;OnlineTime&quot;, 0, (int) (System.currentTimeMillis() - (l2 &gt;= 86400000 ? getDaybyDay(1).getTimeInMillis() - 86400000 : getLogintime())));
            setLogintime(System.currentTimeMillis());
        }
    }

    public void setOnlineTime(long onlineTime) {
        this.onlineTime = onlineTime;
    }

    /*
     * Logintime 系統
     */
    public long getLogintime() {
        return logintime;
    }

    public void setLogintime(long logintime) {
        this.logintime = logintime;
    }

    public Calendar getDaybyDay(int n2) {
        Calendar calendar = Calendar.getInstance();
        calendar.set(Calendar.DATE, calendar.get(Calendar.DATE) + n2);
        calendar.set(Calendar.HOUR_OF_DAY, 0);
        calendar.set(Calendar.AM_PM, 0);
        calendar.set(Calendar.HOUR, 0);
        calendar.set(Calendar.MINUTE, 0);
        calendar.set(Calendar.SECOND, 0);
        calendar.set(Calendar.MILLISECOND, 0);
        return calendar;
    }
    
    /*
     * 新增函數
     * 帳號下的角色統計計算每日活動次數
     */
    public int getEventCount(String eventId) {
        return getEventCount(eventId, 0);
    }

    public int getEventCount(String eventId, int type) {
        try (Connection con = DatabaseConnection.getConnection()) {
            int count = 0;
            PreparedStatement ps = con.prepareStatement(&quot;SELECT * FROM accounts_event WHERE accId = ? AND eventId = ?&quot;);
            ps.setInt(1, getClient().getAccID()); //1
            ps.setString(2, eventId); //2
            ResultSet rs = ps.executeQuery();
            if (rs.next()) {
                /*
                 * 年：calendar.get(Calendar.YEAR)
                 * 月：calendar.get(Calendar.MONTH)+1
                 * 日：calendar.get(Calendar.DAY_OF_MONTH)
                 * 星期：calendar.get(Calendar.DAY_OF_WEEK)-1
                 */
                count = rs.getInt(&quot;count&quot;);
                Timestamp updateTime = rs.getTimestamp(&quot;updateTime&quot;);
                if (type == 0) {
                    Calendar sqlcal = Calendar.getInstance();
                    if (updateTime != null) {
                        sqlcal.setTimeInMillis(updateTime.getTime());
                    }
                    if (sqlcal.get(Calendar.DAY_OF_MONTH) + 1 &lt;= Calendar.getInstance().get(Calendar.DAY_OF_MONTH) || sqlcal.get(Calendar.MONTH) + 1 &lt;= Calendar.getInstance().get(Calendar.MONTH) || sqlcal.get(Calendar.YEAR) + 1 &lt;= Calendar.getInstance().get(Calendar.YEAR)) {
                        count = 0;
                        PreparedStatement psu = con.prepareStatement(&quot;UPDATE accounts_event SET count = 0, updateTime = CURRENT_TIMESTAMP() WHERE accId = ? AND eventId = ?&quot;);
                        psu.setInt(1, id); //1
                        psu.setString(2, eventId); //2
                        psu.executeUpdate();
                        psu.close();
                    }
                }
            } else {
                PreparedStatement psu = con.prepareStatement(&quot;INSERT INTO accounts_event (accId, eventId, count, type) VALUES (?, ?, ?, ?)&quot;);
                psu.setInt(1, getClient().getAccID()); //1 - 4
                psu.setString(2, eventId);
                psu.setInt(3, 0);
                psu.setInt(4, type);
                psu.executeUpdate();
                psu.close();
            }
            rs.close();
            ps.close();
            return count;
        } catch (Exception Ex) {
            System.err.println(&quot;獲取 EventCount 次數.&quot; + Ex);
            return -1;
        }
    }

    /*
     * 增加帳號下的角色統計計算每日活動次數
     */
    public void setEventCount(String eventId) {
        setEventCount(eventId, 0);
    }

    public void setEventCount(String eventId, int type) {
        setEventCount(eventId, type, 1);
    }

    public void setEventCount(String eventId, int type, int count) {
        int eventCount = getEventCount(eventId, type);
        try (Connection con = DatabaseConnection.getConnection()) {
            PreparedStatement ps = con.prepareStatement(&quot;UPDATE accounts_event SET count = ?, type = ?, updateTime = CURRENT_TIMESTAMP() WHERE accId = ? AND eventId = ?&quot;);
            ps.setInt(1, eventCount + count);
            ps.setInt(2, type); //2
            ps.setInt(3, getClient().getAccID()); //3
            ps.setString(4, eventId); //4
            ps.executeUpdate();
            ps.close();
        } catch (Exception Ex) {
            System.err.println(&quot;增加 EventCount 次數失敗.&quot; + Ex);
        }
    }
    
    /*
     * 重置帳號下的角色統計計算每日活動次數
     */
    public void resetEventCount(String eventId) {
        resetEventCount(eventId, 0);
    }

    public void resetEventCount(String eventId, int type) {
        try (Connection con = DatabaseConnection.getConnection()) {
            PreparedStatement ps = con.prepareStatement(&quot;UPDATE accounts_event SET count = 0, type = ?, updateTime = CURRENT_TIMESTAMP() WHERE accId = ? AND eventId = ?&quot;);
            ps.setInt(1, type); //1
            ps.setInt(2, getClient().getAccID()); //2
            ps.setString(3, eventId); //3
            ps.executeUpdate();
            ps.close();
        } catch (Exception Ex) {
            System.err.println(&quot;重置 EventCount 次數失敗&quot; + Ex);
        }
    }
</code></pre>
<p>▶️3. 還是<code>MapleCharacter.java</code>沒變，搜索<strong>函數MapleCharacter</strong>底下的<code>if (ChannelServer) {</code></p>
<p>在下方加上</p>
<pre><code class="language-JAVA">todayonlinetimestamp = new Timestamp(System.currentTimeMillis());//今天在線時間
</code></pre>
<p>▶️4. 打開<code>handling.channel.handler.InterServerHandler.java</code></p>
<p>搜索 <code>player.sendMacros();</code> ，在上面加上</p>
<pre><code class="language-JAVA">//更新在線時間
c.getPlayer().initOnlineTime();
player.setLogintime(System.currentTimeMillis());
</code></pre>
<hr>
<h2 id="️簽到npc腳本">❗️簽到NPC腳本</h2>
<p>最後一步就是找個NPC把腳本貼上，當成每日簽到的NPC來用。<br>
腳本直接放上..自行研究吧。<br>
可以調整每日贈送不一樣的物品或者點數，當然也可以都給..看你開心。</p>
<pre><code class="language-javascript">var status = 0;
var objDate=new Date();
var day=objDate.getDay();
var Month= objDate.getMonth();
var MonthS =[&quot;1月&quot;,&quot;2月&quot;,&quot;3月&quot;,&quot;4月&quot;,&quot;5月&quot;,&quot;6月&quot;,&quot;7月&quot;,&quot;8月&quot;,&quot;9月&quot;,&quot;10月&quot;,&quot;11月&quot;,&quot;12月&quot;];
var weekday = [&quot;日&quot;, &quot;一&quot;, &quot;二&quot;, &quot;三&quot;, &quot;四&quot;, &quot;五&quot;, &quot;六&quot;];
var MonthB=objDate.getMonth()-1;
var tzc =objDate.getDate();
var Year =objDate.getFullYear();

var itemList = Array(
Array(5561000, 5),//從下一個開始
Array(5561000, 3),//1 任意門高級劵
Array(5220000, 10),//2 轉蛋劵
Array(2450000, 3),//3 獵人的幸運
Array(2022179, 5),//4 紫色的蘋果
Array(2022462, 3),//5 卡4
Array(2022463, 3),//6 卡5
Array(2450000, 2),//7 獵人的幸運
Array(5220010, 3),//8 超級轉蛋劵
Array(5510000, 5),//9 原地復活術
Array(5201003, 2),//10 小鋼珠盒子(100)
Array(2101120, 5),//11 魚怪召喚袋
Array(2450000, 1),//12 獵人的幸運
Array(2450000, 1),//13 獵人的幸運
Array(2450000, 1),//14 獵人的幸運
Array(5201001, 1),//15 小鋼珠盒子(500)
Array(4000313, 200),//16 黃金楓葉
Array(2101120, 5), //17 魚怪召喚袋
Array(2101120, 5),//18 魚怪召喚袋
Array(5220010, 1),//19 超級轉蛋劵
Array(2022179, 5),//20 紫色的蘋果
Array(2022179, 5),//21 紫色的蘋果
Array(4000313, 200),//22 黃金楓葉
Array(5220000, 30),//23 轉蛋劵
Array(2022462, 5),//24 卡4
Array(2022463, 5),//25 卡5
Array(5201003, 3),//26 小鋼珠盒子(100)
Array(4000313, 200),//27 黃金楓葉
Array(5561000 , 10),//28 任意門高級劵
Array(5220000, 50),//29 轉蛋劵
Array(5510000, 10),//30 原地復活術
Array(5201001, 1) //31 小鋼珠盒子(500)

); // 因為沒0日 從第1開始設置物品 第一格道具id 第二格設置數量

var debug = false;

function start() {
    status = -1;
	if(debug &amp;&amp; cm.getPlayer().getGMLevel() &lt; 4){
		cm.dispose();
		return;
	}
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == -1) {
        cm.dispose();
    } else {
        if (mode == 0 &amp;&amp; status == 0) {
            cm.dispose();
            return;
        }
        if (mode == 1) status++;
        else status--;
        if (status == 0) {


var tt=31;
if (Month == 0 || Month == 2 || Month == 4 || Month == 6|| Month == 7 || Month == 9 || Month == 11) { // 1月 3月 5月 78 月 10月 12月
tt=32;
}
if (Month == 1) { // 2月的話
tt=29;
}			
              var text3 = 0;
for(var i=1; i&lt;tt; i++) {
text3+= cm.getPlayer().getPrizeLog_n(&quot;&quot;+Year+&quot;年&quot;+MonthS[Month]+i+&quot;日&quot;);}
             
              var ta=&quot;#b&quot;;

              var text = &quot;&quot;;

		for(var i=1,ytz=1; i&lt;tt; i++,ytz++) {
if (cm.getPlayer().getPrizeLog_n(&quot;&quot;+Year+&quot;年&quot;+MonthS[Month]+i+&quot;日&quot;) == 0) {
ta=&quot;#b&quot;;
}
if (cm.getPlayer().getPrizeLog_n(&quot;&quot;+Year+&quot;年&quot;+MonthS[Month]+i+&quot;日&quot;) != 0) {
ta=&quot;#r&quot;;
}
			text+=ta+ytz+&quot;#i&quot;+itemList[i][0]+&quot;#&quot;+((i + 0) % 7 == 0 ? &quot;\r\n&quot;: &quot;&quot;);
		}
            var text2 = 0;

 cm.sendSimple(&quot;#e現在時間:#b&quot;+Year+&quot;年&quot;+MonthS[Month]+tzc+&quot;日星期&quot;+weekday[day]+&quot;\r\n#k本月累積簽到【 #r&quot;+ text3 +&quot;#k 】天&quot;+&quot;\r\n#k本日在線時間【 #r&quot;+ cm.getOnlineTime() +&quot;#k 】分&quot;+&quot;\r\n#b上線時間需滿60分鐘才可進行每日簽到&quot;+&quot;\r\n#k&quot;+&quot;\r\n#L0# #r每日簽到獲得100點#l\r\n\r\n#k&quot;);
} else if (status == 1) {


            if (selection == 0) {
 if(!cm.canHold(itemList[tzc][0], itemList[tzc][1])){
             cm.sendOk(&quot;您的背包空間不足&quot;);
             cm.dispose();
             return;   
             }
  if (cm.getPlayer().getPrizeLog_n(&quot;&quot;+Year+&quot;年&quot;+MonthS[Month]+tzc+&quot;日&quot;) &lt; 1 &amp;&amp; cm.getOnlineTime() &gt;= 60) { // 在線時數
                    cm.getPlayer().setPrizeLog_n(&quot;&quot;+Year+&quot;年&quot;+MonthS[Month]+tzc+&quot;日&quot;);
           
                  //  cm.gainItem(itemList[tzc][0], itemList[tzc][1]);
					cm.getPlayer().modifyCSPoints(1, 100, true);

                    cm.sendOk(&quot;恭喜您成功進行簽到並獲取100點!!&quot;);
     cm.worldMessage(5,&quot;『xx谷』&quot; + &quot; : &quot; + &quot;玩家 &quot; + cm.getChar().getName() + &quot; 已進行每日簽到!!!&quot;);
                    cm.dispose();
                        
                } else{ 
                    cm.sendOk(&quot;已進行每日簽到或上線時間未達60分鐘!。&quot;);
                    cm.dispose();
                 } 
} 
} 
}
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[楓之谷私服武陵道場NPC JS腳本]]></title>
        <id>https://Z1Nhouse.github.io//post/dIb0rHox</id>
        <link href="https://Z1Nhouse.github.io//post/dIb0rHox">
        </link>
        <updated>2020-01-30T07:15:11.000Z</updated>
        <content type="html"><![CDATA[<p>適用端口：120白狐端</p>
<h2 id="演示">演示：</h2>
<p>兌換道具數量可在腳本內自行更改。<br>
<img src="https://Z1Nhouse.github.io//post-images/1581868964190.png" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868967442.png" alt=""><br>
<img src="https://Z1Nhouse.github.io//post-images/1581868972678.png" alt=""></p>
<ul>
<li>中文化：本人</li>
<li>NPC：2091005</li>
</ul>
<h2 id="腳本">腳本：</h2>
<pre><code class="language-javascript">var status = -1;
var sel;
var mapid;

function start() {
    mapid = cm.getMapId();

    if (mapid == 925020001) {
	cm.sendSimple(&quot;我的師傅是武陵中擁有最高功力的人，您現在是想告訴我您要挑戰我的師傅嗎？不要說我沒有警告過你。#b \n\r #L0#我想單人挑戰他#l \n\r #L1#我想組隊挑戰他#l \n\r #L2#我想兌換腰帶#l \n\r #L3#我想重設訓練點#l \n\r #L5#什麼是武陵修煉場？#l&quot;);
    } else if (isRestingSpot(mapid)) {
	cm.sendSimple(&quot;我很驚訝你已經安全地達到了這個樓層，但是不會再這麼容易了。你怎麼想？你想繼續嗎？#b \n\r #L0#是的，我要繼續。#l \n\r #L1#我想離開。#l \n\r #L2#我想儲存我的紀錄。#l&quot;);
    } else {
	cm.sendYesNo(&quot;什麼？你準備要離開了？您還可以進入下一個級別呢！你確定真的要離開？&quot;);
    }
}

function action(mode, type, selection) {
    if (mapid == 925020001) {
	if (mode == 1) {
	    status++;
	} else {
	    cm.dispose();
		return;
	}
	if (status == 0) {
	    sel = selection;

	    if (sel == 5) {
		cm.sendNext(&quot;我的師傅是武陵中擁有最高功力的人，且他也是建立這個武陵修練塔的人。武陵道場是一個龐大的訓練設施，共有38層。 每個樓層難度級別都不同。當然，憑藉您的功力，到達頂樓是不可能的...&quot;);
		cm.dispose();
	    } else if (sel == 3) {
		cm.sendYesNo(&quot;您知道如果重新設置訓練點，它將恢復為0，對吧？老實說，這不一定是壞事。重置訓練點並重新開始後，那麼您就可以再次收到皮帶了。 你想重設訓練點嗎？&quot;);
	    } else if (sel == 2) {
		cm.sendSimple(&quot;到目前為止，您的總訓練點數是 #b&quot;+cm.getDojoPoints()+&quot;#k。 我的師父惜愛有才華的人，因此，如果您積累了足夠的訓練點， 您將可以根據自己的訓練點獲得腰帶...\n\r #L0##i1132000:# #t1132000# (50)#l \n\r #L1##i1132001:# #t1132001# (150)#l \n\r #L2##i1132002:# #t1132002# (300)#l \n\r #L3##i1132003:# #t1132003# (450)#l \n\r #L4##i1132004:# #t1132004# (600)#l\r\n&quot;);
	    } else if (sel == 1) {
		if (cm.getParty() != null) {
		    if (cm.isLeader()) {
			cm.sendOk(&quot;您要立即進入嗎？&quot;);
		    } else {
			cm.sendOk(&quot;嘿，您甚至都不是隊長。您想偷偷溜進去做什麼？如果您想進入該場所，請告訴您的隊長與我交談。&quot;);
		    }
		}
	    } else if (sel == 0) {
		if (cm.getParty() != null) {
			cm.sendOk(&quot;請離開你的隊伍。&quot;);
			cm.dispose();
		}
		var record = cm.getQuestRecord(150000);
		var data = record.getCustomData();

		if (data != null) {
		    var idd = get_restinFieldID(parseInt(data));
		    if (idd != 925020002) {
		        cm.dojoAgent_NextMap(true, true , idd );
		        record.setCustomData(null);
		    } else {
			cm.sendOk(&quot;請等等再嘗試一次。&quot;);
		    }
		} else {
		    cm.start_DojoAgent(true, false);
		}
		cm.dispose();
	    // cm.sendYesNo(&quot;The last time you took the challenge yourself, you were able to reach Floor #18. I can take you straight to that floor, if you want. Are you interested?&quot;);
	    }
	} else if (status == 1) {
	    if (sel == 3) {
		cm.setDojoRecord(true);
		cm.sendOk(&quot;我已將您的訓練點重設為0&quot;);
	    } else if (sel == 2) {
		var record = cm.getDojoRecord();
		var required = 0;
		
		switch (record) {
		    case 0:
			required = 500;
			break;
		    case 1:
			required = 1500;
			break;
		    case 2:
			required = 3000;
			break;
		    case 3:
			required = 4500;
			break;
		    case 4:
			required = 6000;
			break;
			case 5:
			required = 9000;
			break;
			case 6:
			required = 11000;
			break;
			case 7:
			required = 15000;
			break;
		}

		if (record == selection &amp;&amp; cm.getDojoPoints() &gt;= required) {
		    var item = 1132000 + record;
		    if (cm.canHold(item)) {
			cm.gainItem(item, 1);
			cm.setDojoRecord(false);
		    } else {
			cm.sendOk(&quot;請檢查背包中是否還有空位。&quot;);
		    }
		} else {
		    cm.sendOk(&quot;您已經擁有或訓練點不足。請嘗試先獲取較低階的腰帶。&quot;);
		}
		cm.dispose();
	    } else if (sel == 1) {
		cm.start_DojoAgent(true, true);
		cm.dispose();
	    }
	}
    } else if (isRestingSpot(mapid)) {
	if (mode == 1) {
	    status++;
	} else {
	    cm.dispose();
	    return;
	}

	if (status == 0) {
	    sel = selection;

	    if (sel == 0) {
		if (cm.getParty() == null || cm.isLeader()) {
		    cm.dojoAgent_NextMap(true, true);
		} else {
		    cm.sendOk(&quot;只有隊長可以繼續前進。&quot;);
		}
		//cm.getQuestRecord(150000).setCustomData(null);
		cm.dispose();
	    } else if (sel == 1) {
		cm.askAcceptDecline(&quot;你想退出嗎？你真的想離開這裡嗎？&quot;);
	    } else if (sel == 2) {
		if (cm.getParty() == null) {
			var stage = get_stageId(cm.getMapId());

			cm.getQuestRecord(150000).setCustomData(stage);
			cm.sendOk(&quot;我剛剛記錄了您的進度。下次您到達這裡時，我會直接將您送到此樓層。&quot;);
			cm.dispose();
		} else {
			cm.sendOk(&quot;嘿..您無法記錄與隊伍合作的進度...&quot;);
			cm.dispose();
		}
	    }
	} else if (status == 1) {
	    if (sel == 1) {
		if (cm.isLeader()) {
			cm.warpParty(925020002);
		} else {
			cm.warp(925020002);
		}
	    }
	    cm.dispose();
	}
    } else {
	if (mode == 1) {
		if (cm.isLeader()) {
			cm.warpParty(925020002);
		} else {
			cm.warp(925020002);
		}
	}
	cm.dispose();
    }
}

function get_restinFieldID(id) {
	var idd = 925020002;
    switch (id) {
	case 1:
	    idd =  925020600;
	    break;
	case 2:
	    idd =  925021200;
	    break;
	case 3:
	    idd =  925021800;
	    break;
	case 4:
	    idd =  925022400;
	    break;
	case 5:
	    idd =  925023000;
	    break;
	case 6:
	    idd =  925023600;
	    break;
    }
    for (var i = 0; i &lt; 10; i++) {
	var canenterr = true;
	for (var x = 1; x &lt; 39; x++) {
		var map = cm.getMap(925020000 + 100 * x + i);
		if (map.getCharactersSize() &gt; 0) {
			canenterr = false;
			break;
		}
	}
	if (canenterr) {
		idd += i;
		break;
	}
}
	return idd;
}

function get_stageId(mapid) {
    if (mapid &gt;= 925020600 &amp;&amp; mapid &lt;= 925020614) {
	return 1;
    } else if (mapid &gt;= 925021200 &amp;&amp; mapid &lt;= 925021214) {
	return 2;
    } else if (mapid &gt;= 925021800 &amp;&amp; mapid &lt;= 925021814) {
	return 3;
    } else if (mapid &gt;= 925022400 &amp;&amp; mapid &lt;= 925022414) {
	return 4;
    } else if (mapid &gt;= 925023000 &amp;&amp; mapid &lt;= 925023014) {
	return 5;
    } else if (mapid &gt;= 925023600 &amp;&amp; mapid &lt;= 925023614) {
	return 6;
    }
    return 0;
}

function isRestingSpot(id) {
    return (get_stageId(id) &gt; 0);
}
</code></pre>
]]></content>
    </entry>
</feed>